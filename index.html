<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8" />
  <title>Pi SDK Baseline</title>
  <script src="https://sdk.minepi.com/pi-sdk.js"></script>
</head>
<body>

<h1>Pi SDK Baseline</h1>
<button onclick="login()">Login with Pi</button>
<button onclick="pay()">Pay 1 Pi</button>

<script>
Pi.init({ version: "2.0" });

function login() {
  Pi.authenticate(["username"], (auth) => {
    document.body.innerHTML += `<p>Welcome ${auth.user.username}</p>`;
  });
}

function pay() {
  Pi.createPayment({
    amount: 1,
    memo: "Test payment",
    metadata: { test: true }
  }, {
    onReadyForServerApproval: async (paymentId) => {
      await fetch("/api/pi", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({
          action: "approve",
          paymentId
        })
      });
    },
    onCompleted: () => alert("Payment completed"),
    onCancelled: () => alert("Payment cancelled"),
    onError: e => alert(e)
  });
}
</script>

</body>
</html>
