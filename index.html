<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Idle Realm</title>

<style>
:root{
  --bg:#0b1220;--card:#141c33;--card2:#1b2546;
  --accent:#3b6cff;--bronze:#c27c2c;
  --text:#e6ecff;--muted:#9aa4c7;
  --ok:#22c55e;
}
*{box-sizing:border-box;font-family:system-ui}
body{margin:0;background:linear-gradient(180deg,#0a1020,#050a14);color:var(--text)}
header{
  position:sticky;top:0;z-index:10;
  background:#060b18;padding:8px 12px;
  display:flex;gap:10px;justify-content:space-between;font-size:14px
}
main{padding:16px;max-width:520px;margin:auto}
.card{background:linear-gradient(180deg,var(--card),var(--card2));border-radius:16px;padding:16px;margin-bottom:16px}
button{width:100%;border:none;border-radius:14px;padding:14px;margin-bottom:10px;background:var(--accent);color:white;font-size:16px;font-weight:600}
button.bronze{background:linear-gradient(180deg,#e0a24c,#b87328);color:#1a0f00}
button:disabled{opacity:.45}
.grid{display:grid;grid-template-columns:repeat(3,1fr);gap:10px}
.tile{
  background:#0f1730;border-radius:12px;height:70px;
  display:flex;align-items:center;justify-content:center;
  font-size:28px;cursor:pointer
}
.small{color:var(--muted);font-size:13px}
.obj{font-size:14px;margin-bottom:6px}
.obj.ok{color:var(--ok)}
</style>
</head>

<body>
<header>
<span>üë• <b id="pop"></b></span>
<span>‚öíÔ∏è <b id="prod"></b></span>
<span>ü•â <b id="bronze"></b></span>
<span>üõ°Ô∏è <b id="stab"></b>%</span>
<span>‚è≥ <b id="time"></b></span>
</header>

<main>
<h1>Idle Realm</h1>
<div class="small">A living world shaped by time and choices</div>

<div class="card">
<h2>Era</h2>
<div id="eraTitle"></div>
<div id="eraDesc" class="small"></div>
<div id="objectives"></div>
<button id="advanceEra" class="bronze" style="display:none"></button>
</div>

<div class="card">
<h2>Build</h2>
<button id="btnSettlement"></button>
<button id="btnWorkshop"></button>
<button id="btnMine"></button>
<button id="btnCouncil"></button>
<button id="btnCouncil2"></button>
<div id="info" class="small"></div>
</div>

<div class="card">
<h2>City</h2>
<div id="city" class="grid"></div>
<div id="removeHint" class="small"></div>
</div>

<div class="card">
<h2>Events</h2>
<div id="events"></div>
</div>
</main>

<script>
let MAX_SLOTS=9;
const COOLDOWN=8;
const COST={settlement:15,workshop:20,mine:20,council:30,council2:30};

const DEFAULT={
  era:"foundations",pop:12,prod:30,bronze:0,stab:100,time:0,
  lastAction:0,bronzeStableTime:0,
  buildings:["‚öíÔ∏è"],events:["Realm founded with basic craftsmanship"]
};

let state=JSON.parse(localStorage.getItem("idleRealm"))||structuredClone(DEFAULT);

function save(){localStorage.setItem("idleRealm",JSON.stringify(state))}
function log(m){state.events.unshift("‚Ä¢ "+m);state.events=state.events.slice(0,10)}
function canAct(){return Date.now()-state.lastAction>=COOLDOWN*1000}

function update(){
  pop.textContent=state.pop;
  prod.textContent=state.prod.toFixed(1);
  bronze.textContent=state.bronze.toFixed(1);
  stab.textContent=Math.min(100,state.stab).toFixed(0);
  time.textContent=state.time;

  eraTitle.innerHTML="<b>"+(state.era==="foundations"?"Foundations":"Bronze Age")+"</b>";
  eraDesc.textContent=state.era==="foundations"
    ?"Fast growth to learn the game."
    :"Growth slows. Governance matters.";

  btnSettlement.textContent="üè† Settlement (15 ‚öíÔ∏è)";
  btnWorkshop.textContent="‚öíÔ∏è Workshop (20 ‚öíÔ∏è)";
  btnCouncil.textContent="üèõÔ∏è Council (30 ‚öíÔ∏è)";
  btnMine.textContent="‚õèÔ∏è Mine (20 ‚öíÔ∏è)";
  btnCouncil2.textContent="üèõÔ∏èüèõÔ∏è Council II (30 ü•â)";

  btnMine.style.display=state.era==="bronze"?"block":"none";
  btnCouncil2.style.display=state.era==="bronze"?"block":"none";
  removeHint.textContent=state.era==="bronze"?"Tap a building to remove it (no refund).":"";

  city.innerHTML="";
  state.buildings.forEach((b,i)=>{
    const t=document.createElement("div");
    t.className="tile";t.textContent=b;
    t.onclick=()=>removeBuilding(i);
    city.appendChild(t);
  });
  for(let i=state.buildings.length;i<MAX_SLOTS;i++){
    const t=document.createElement("div");
    t.className="tile";city.appendChild(t);
  }

  events.innerHTML=state.events.map(e=>`<div>${e}</div>`).join("");
  save();
}

function build(type){
  if(!canAct())return;
  if(type==="settlement"){state.prod-=15;state.pop+=4;state.stab-=6;state.buildings.push("üè†")}
  if(type==="workshop"){state.prod-=20;state.buildings.push("‚öíÔ∏è")}
  if(type==="mine"){state.prod-=20;state.stab-=4;state.buildings.push("‚õèÔ∏è")}
  if(type==="council"){state.prod-=30;state.stab+=15;state.buildings.push("üèõÔ∏è")}
  if(type==="council2"){state.bronze-=30;state.stab+=10;state.buildings.push("üèõÔ∏èüèõÔ∏è")}
  state.lastAction=Date.now();log(type+" built");update();
}

function removeBuilding(i){
  const b=state.buildings[i];
  if(b==="üè†")state.pop-=4;
  if(b==="‚õèÔ∏è")state.stab+=2;
  if(b==="üèõÔ∏è"||b==="üèõÔ∏èüèõÔ∏è")state.stab-=5;
  state.buildings.splice(i,1);
  log(b+" removed");update();
}

btnSettlement.onclick=()=>build("settlement");
btnWorkshop.onclick=()=>build("workshop");
btnMine.onclick=()=>build("mine");
btnCouncil.onclick=()=>build("council");
btnCouncil2.onclick=()=>build("council2");

setInterval(()=>{
  state.time++;
  const w=state.buildings.filter(b=>b==="‚öíÔ∏è").length;
  const m=state.buildings.filter(b=>b==="‚õèÔ∏è").length;
  state.prod+=w*0.25;
  if(state.era==="bronze")state.bronze+=m*0.025*(1+w*0.3);
  update();
},1000);

update();
</script>
</body>
</html>
