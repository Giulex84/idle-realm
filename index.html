<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Idle Realm</title>

<style>
  body {
    margin: 0;
    font-family: system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
    background: radial-gradient(circle at top, #0b1a33, #050914);
    color: #e8eefc;
  }

  header {
    padding: 14px;
    display: flex;
    justify-content: space-around;
    background: rgba(0,0,0,0.4);
    backdrop-filter: blur(6px);
    font-weight: bold;
  }

  main {
    padding: 20px;
  }

  h1 {
    margin-top: 10px;
  }

  .card {
    background: rgba(255,255,255,0.05);
    border-radius: 16px;
    padding: 16px;
    margin-bottom: 20px;
    box-shadow: inset 0 0 0 1px rgba(255,255,255,0.05);
  }

  .buttons {
    display: flex;
    flex-wrap: wrap;
    gap: 12px;
  }

  button {
    flex: 1;
    min-width: 140px;
    padding: 14px;
    border-radius: 12px;
    border: none;
    font-size: 15px;
    font-weight: 600;
    background: #2563eb;
    color: white;
  }

  button:disabled {
    background: #334155;
    opacity: 0.6;
  }

  ul {
    padding-left: 20px;
    font-size: 14px;
  }
</style>
</head>

<body>

<header>
  <div>ğŸ‘¥ <span id="pop">0</span></div>
  <div>âš’ï¸ <span id="prod">0</span></div>
  <div>ğŸ›¡ï¸ <span id="stab">0</span>%</div>
  <div>â³ <span id="eraName">Foundations</span></div>
</header>

<main>

<h1>Idle Realm</h1>

<div class="card">
  <h2>Build</h2>
  <div class="buttons">
    <button id="settlementBtn">ğŸ  Settlement</button>
    <button id="workshopBtn">âš’ï¸ Workshop</button>
    <button id="councilBtn">ğŸ›ï¸ Council</button>
  </div>
</div>

<div class="card">
  <h2>Era Progress</h2>
  <p id="eraDesc"></p>
</div>

<div class="card">
  <h2>Events</h2>
  <ul id="log"></ul>
</div>

</main>

<script>
/* =======================
   STATE
======================= */
let state = JSON.parse(localStorage.getItem("idleRealm")) || {
  population: 10,
  production: 10,
  stability: 100,
  settlements: 0,
  workshops: 0,
  councils: 0,
  era: 0,
  tick: 0
};

const ERAS = [
  {
    name: "Foundations",
    desc: "Basic growth. Limited expansion.",
    popCap: 100,
    settlementCap: 5,
    workshopCap: 3
  },
  {
    name: "Expansion",
    desc: "Faster growth. Higher limits.",
    popCap: 500,
    settlementCap: 20,
    workshopCap: 15
  }
];

/* =======================
   HELPERS
======================= */
function log(msg) {
  const li = document.createElement("li");
  li.textContent = msg;
  document.getElementById("log").prepend(li);
}

function save() {
  localStorage.setItem("idleRealm", JSON.stringify(state));
}

function canBuild(cost, stabCost) {
  return state.production >= cost && state.stability > stabCost;
}

/* =======================
   BUILD ACTIONS
======================= */
document.getElementById("settlementBtn").onclick = () => {
  if (!canBuild(10, 10)) return;
  if (state.settlements >= ERAS[state.era].settlementCap) return;

  state.production -= 10;
  state.population += 5;
  state.stability -= 10;
  state.settlements++;
  log("Built Settlement (+5 pop, -10 stab)");
};

document.getElementById("workshopBtn").onclick = () => {
  if (!canBuild(15, 15)) return;
  if (state.workshops >= ERAS[state.era].workshopCap) return;

  state.production -= 15;
  state.production += 3;
  state.stability -= 15;
  state.workshops++;
  log("Built Workshop (+3 prod, -15 stab)");
};

document.getElementById("councilBtn").onclick = () => {
  if (!canBuild(20, 0)) return;
  if (state.councils >= 1) return;

  state.production -= 20;
  state.stability += 20;
  state.councils++;
  log("Built Council (+20 stab)");
};

/* =======================
   GAME LOOP
======================= */
setInterval(() => {
  state.tick++;
  state.production += state.workshops * 0.5;
  state.stability = Math.min(100, state.stability + 0.1);

  // ERA CHECK
  if (
    state.era === 0 &&
    state.population >= 80 &&
    state.settlements >= 3
  ) {
    state.era = 1;
    log("Era advanced to Expansion");
  }

  updateUI();
  save();
}, 1000);

/* =======================
   UI
======================= */
function updateUI() {
  document.getElementById("pop").textContent = state.population.toFixed(1);
  document.getElementById("prod").textContent = state.production.toFixed(1);
  document.getElementById("stab").textContent = state.stability.toFixed(0);
  document.getElementById("eraName").textContent = ERAS[state.era].name;
  document.getElementById("eraDesc").textContent = ERAS[state.era].desc;

  document.getElementById("settlementBtn").disabled =
    !canBuild(10,10) || state.settlements >= ERAS[state.era].settlementCap;

  document.getElementById("workshopBtn").disabled =
    !canBuild(15,15) || state.workshops >= ERAS[state.era].workshopCap;

  document.getElementById("councilBtn").disabled =
    !canBuild(20,0) || state.councils >= 1;
}

updateUI();
</script>

</body>
</html>
