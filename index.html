<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Idle Realm â€“ Recovery</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script src="https://sdk.minepi.com/pi-sdk.js"></script>
<script>
  Pi.init({ version: "2.0" });
</script>

<style>
body{
  margin:0;
  font-family:system-ui,-apple-system,sans-serif;
  background:#020617;
  color:#e5e7eb;
}
#hud{
  position:sticky;
  top:0;
  background:#020617;
  padding:10px;
  display:flex;
  justify-content:space-around;
  border-bottom:1px solid #1f2937;
}
main{
  padding:16px;
}
button{
  padding:12px;
  margin:6px 6px 0 0;
  background:#2563eb;
  border:none;
  color:white;
  border-radius:8px;
  font-weight:600;
}
button:active{
  background:#1d4ed8;
}
.log{
  margin-top:12px;
  font-size:14px;
}
.log div{
  margin-bottom:4px;
}
</style>
</head>

<body>

<div id="hud">
  ğŸ‘¥ <span id="pop">0</span>
  âš’ <span id="prod">0</span>
  ğŸ›¡ <span id="stab">0</span>%
  â± <span id="ticks">0</span>
</div>

<main>
  <h1>Idle Realm (Recovery)</h1>

  <button onclick="buildSettlement()">ğŸ  Build Settlement</button>
  <button onclick="buildWorkshop()">âš’ Build Workshop</button>
  <button onclick="buildCouncil()">ğŸ› Build Council</button>

  <div class="log" id="log"></div>
</main>

<script>
const KEY = "idle_realm_recovery";

let state = {
  pop: 10,
  prod: 5,
  stab: 80,
  settlements: 1,
  workshops: 0,
  councils: 0,
  ticks: 0,
  log: []
};

function load(){
  const s = localStorage.getItem(KEY);
  if(s) state = JSON.parse(s);
}

function save(){
  localStorage.setItem(KEY, JSON.stringify(state));
}

function log(msg){
  state.log.unshift(msg);
  if(state.log.length > 6) state.log.pop();
}

function buildSettlement(){
  state.pop += 2;
  state.settlements++;
  state.stab -= 2;
  log("Built Settlement (+2 pop, -2 stab)");
  render(); save();
}

function buildWorkshop(){
  state.prod += 3;
  state.workshops++;
  state.stab -= 1;
  log("Built Workshop (+3 prod, -1 stab)");
  render(); save();
}

function buildCouncil(){
  state.stab += 5;
  state.councils++;
  log("Built Council (+5 stab)");
  render(); save();
}

function tick(){
  state.pop += state.settlements * 0.02;
  state.prod += state.workshops * 0.04;
  state.stab -= state.settlements * 0.01;
  state.stab = Math.max(0, Math.min(100, state.stab));
  state.ticks++;
  render(); save();
}

function render(){
  pop.textContent = state.pop.toFixed(1);
  prod.textContent = state.prod.toFixed(1);
  stab.textContent = Math.round(state.stab);
  ticks.textContent = state.ticks;

  const l = document.getElementById("log");
  l.innerHTML = "";
  state.log.forEach(e=>{
    const d = document.createElement("div");
    d.textContent = "â€¢ " + e;
    l.appendChild(d);
  });
}

load();
render();
setInterval(tick, 1000);
</script>

</body>
</html>
