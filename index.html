<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Idle Realm</title>

<style>
body {
  margin:0;
  font-family: system-ui, -apple-system, BlinkMacSystemFont;
  background: radial-gradient(circle at top, #14213d, #020617);
  color:#e5e7eb;
}
header {
  padding:12px;
  font-size:14px;
  display:flex;
  justify-content:space-around;
  background:#020617;
}
h1 { margin:20px 16px 0; font-size:32px; }
p.subtitle { margin:4px 16px 16px; opacity:0.7 }

.card {
  margin:16px;
  padding:16px;
  border-radius:16px;
  background:rgba(255,255,255,0.05);
}

button {
  width:100%;
  padding:14px;
  margin-top:10px;
  border:none;
  border-radius:14px;
  font-size:16px;
  background:#2563eb;
  color:white;
}
button:disabled {
  opacity:0.4;
}

.grid {
  display:grid;
  grid-template-columns:repeat(3,1fr);
  gap:12px;
}

.tile {
  height:70px;
  border-radius:14px;
  background:rgba(255,255,255,0.08);
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:32px;
}

.log {
  font-size:14px;
  opacity:0.85;
}
</style>
</head>

<body>

<header>
  üë• <span id="pop"></span>
  ‚öíÔ∏è <span id="prod"></span>
  üõ°Ô∏è <span id="stab"></span>%
  ‚è≥ <span id="time"></span>
</header>

<h1>Idle Realm</h1>
<p class="subtitle">A living world shaped by time and choices</p>

<div class="card">
<h2>Build</h2>
<button id="bSettlement">üè† Settlement</button>
<button id="bWorkshop">üõ†Ô∏è Workshop</button>
<button id="bCouncil">üèõÔ∏è Council</button>
<div id="costs"></div>
<div id="cooldown"></div>
</div>

<div class="card">
<h2>City</h2>
<div class="grid" id="city"></div>
</div>

<div class="card">
<h2>Era</h2>
<div>Foundations ‚Äî slow growth. Every choice matters.</div>
</div>

<div class="card">
<h2>Events</h2>
<div id="events" class="log"></div>
</div>

<div class="card">
<h2>Realm Chronicle</h2>
<div id="chronicle" class="log"></div>
</div>

<script>
/* ==== STATE ==== */
let population = 10;
let production = 30;
let stability = 100;
let time = 0;

let settlements = 0;
let workshops = 0;
let councilBuilt = false;

let cooldown = 0;
const COOLDOWN_MAX = 10;

const citySize = 9;
let city = Array(citySize).fill(null);

/* ==== UI ==== */
const popEl = document.getElementById("pop");
const prodEl = document.getElementById("prod");
const stabEl = document.getElementById("stab");
const timeEl = document.getElementById("time");
const eventsEl = document.getElementById("events");
const cityEl = document.getElementById("city");
const costsEl = document.getElementById("costs");
const cdEl = document.getElementById("cooldown");

/* ==== CHRONICLE ==== */
const chronicleTexts = [
 "The first clans gather around fire and stone.",
 "Population needs shelter to grow.",
 "Workshops turn effort into progress.",
 "Order preserves stability.",
 "A stronger age lies ahead: Bronze.",
 "Every decision echoes through time."
];
let chronicleIndex = 0;

function updateChronicle(){
 document.getElementById("chronicle").textContent =
 chronicleTexts[chronicleIndex];
 chronicleIndex = (chronicleIndex+1)%chronicleTexts.length;
}

/* ==== HELPERS ==== */
function log(msg){
 eventsEl.innerHTML = "‚Ä¢ " + msg + "<br>" + eventsEl.innerHTML;
}

function renderCity(){
 cityEl.innerHTML="";
 city.forEach(t=>{
  const d=document.createElement("div");
  d.className="tile";
  d.textContent=t||"";
  cityEl.appendChild(d);
 });
}

function emptySlot(){
 return city.findIndex(t=>t===null);
}

function updateUI(){
 popEl.textContent=population.toFixed(1);
 prodEl.textContent=production.toFixed(1);
 stabEl.textContent=Math.max(0,Math.min(100,stability)).toFixed(0);
 timeEl.textContent=time;

 costsEl.innerHTML=
  `Settlement: 15 prod<br>
   Workshop: 20 prod<br>
   Council: 30 prod`;

 cdEl.textContent = cooldown>0
 ? `Cooldown: ${cooldown}s before next decision`
 : "";

 document.getElementById("bSettlement").disabled =
  cooldown>0 || production<15 || emptySlot()<0;

 document.getElementById("bWorkshop").disabled =
  cooldown>0 || production<20 || emptySlot()<0;

 document.getElementById("bCouncil").disabled =
  cooldown>0 || councilBuilt || production<30 || emptySlot()<0;
}

/* ==== BUILD ACTIONS ==== */
function build(type){
 if(cooldown>0) return;

 const slot = emptySlot();
 if(slot<0){ log("No empty tiles"); return; }

 if(type==="settlement"){
  production-=15;
  population+=4;
  stability-=6;
  settlements++;
  city[slot]="üè†";
  log("Settlement built (+4 pop, -6 stability)");
 }

 if(type==="workshop"){
  production-=20;
  workshops++;
  city[slot]="üõ†Ô∏è";
  log("Workshop built (+prod over time)");
 }

 if(type==="council"){
  production-=30;
  stability+=15;
  councilBuilt=true;
  city[slot]="üèõÔ∏è";
  log("Council established (+15 stability)");
 }

 cooldown=COOLDOWN_MAX;
 updateUI();
}

/* ==== BUTTONS ==== */
bSettlement.onclick=()=>build("settlement");
bWorkshop.onclick=()=>build("workshop");
bCouncil.onclick=()=>build("council");

/* ==== TICK ==== */
setInterval(()=>{
 time++;

 if(workshops>0){
  production += workshops * 0.6;
 }

 if(population>settlements*6){
  stability -= 0.1;
 }

 if(cooldown>0) cooldown--;

 if(time%8===0) updateChronicle();

 updateUI();
 renderCity();
},1000);

updateChronicle();
updateUI();
renderCity();
</script>

</body>
</html>
